<!DOCTYPE html>
<html lang="fr">
<head>
  <title>V√©rification du code</title>
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  {{ include('security/login_styles.css.twig') }}
  <style>
    input#code {
  pointer-events: auto !important;
  opacity: 1 !important;
  background-color: rgba(255, 255, 255, 0.07) !important;
  color: white !important;
  border: 1px solid rgba(255, 255, 255, 0.3);
}

input#code:focus {
  outline: none;
  background-color: rgba(255, 255, 255, 0.12);
  border-color: #23a2f6;
}

  </style>
</head>
<body>

<div class="background">
  <div class="shape"></div>
  <div class="shape"></div>

  <div class="logo-wrapper">
    <img src="{{ asset('logo_civismart.png') }}" alt="Logo gauche" class="logo-left">
    <img src="{{ asset('logo_civismart.png') }}" alt="Logo droite" class="logo-right">
  </div>
</div>
  <form method="post" class="fade-in">
    <h3>üßæ V√©rification du code</h3>

    {% for message in app.flashes('success') %}
      <div class="alert alert-success">{{ message }}</div>
    {% endfor %}
    {% for message in app.flashes('error') %}
      <div class="alert alert-danger">{{ message }}</div>
    {% endfor %}

    <label for="code">Code re√ßu</label>
    <input type="text" name="code" id="code" placeholder="4 chiffres" maxlength="4">
    
    <button type="submit">V√©rifier</button>

    <p style="margin-top: 10px; text-align: center;">
      <a href="{{ path('app_login') }}" style="color: #00f;">‚Üê Retour</a>
    </p>
  </form>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  window.addEventListener("load", function () {
    document.querySelector("form").classList.add("fade-in");
  });

  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");
    const codeInput = document.getElementById("code");

    form.addEventListener("submit", function (e) {
      const code = codeInput.value.trim();
      const codeRegex = /^[0-9]{4}$/;

      const existingError = document.querySelector(".error-msg");
      if (existingError) existingError.remove();

      if (!codeRegex.test(code)) {
        e.preventDefault();

        const errorMsg = document.createElement("div");
        errorMsg.className = "error-msg";
        errorMsg.style.color = "red";
        errorMsg.style.marginBottom = "10px";
        errorMsg.textContent = "Veuillez entrer un code √† 4 chiffres.";
        codeInput.parentNode.insertBefore(errorMsg, codeInput);
      }
    });
  });
</script>

</body>
</html>
