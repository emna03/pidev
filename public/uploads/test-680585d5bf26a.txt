exercice 1 :
SELECT last_name, first_name, hire_date
FROM employees
WHERE commission_pct IS NOT NULL
ORDER BY last_name, first_name;

exercice 2 :
SELECT department_id, COUNT(*) AS total_employees, AVG(salary) AS avg_salary
FROM employees
GROUP BY department_id
HAVING AVG(salary) > 30000
ORDER BY SUM(salary) DESC;

exercice 3:
SELECT e.last_name, e.first_name, d.department_name, m.last_name AS manager_name
FROM employees e
LEFT JOIN departments d ON e.department_id = d.department_id
LEFT JOIN employees m ON e.manager_id = m.employee_id
ORDER BY d.department_name, e.last_name;

exercice 4:

SELECT e.last_name,
       e.first_name,
       e.salary,
       d.department_name
FROM employees e
JOIN departments d ON e.department_id = d.department_id
WHERE e.salary = (
    SELECT MAX(salary)
    FROM employees
    WHERE department_id = e.department_id
)
ORDER BY d.department_name;
